"use strict";var voteTeam,gameDate,voteEndTime,expired,shortUrl,hostFlag,hostName,hostNameCN,guestFlag,guestName,guestNameCN,testUrl="result.json",cdn_root_path="./",ajaxGet=function(e,t,a){$.ajax({type:"GET",url:e,dataType:"json"}).done(function(e,a,o){t(e)}).fail(function(e,t,o){a(o)})},ajaxPost=function(e,t,a,o){$.ajax({type:"POST",url:e,contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:t}).done(function(e,t,o){a(e)}).fail(function(e,t,a){o(a)})},showInfo=function(e){console.log(e),gameDate=e.meta.startAt,voteEndTime=e.meta.endAt,expired=e.meta.expired,expired=!1,shortUrl=e.short_url,hostFlag=e.host.flag,hostName=e.host.name,hostNameCN=e.host.nameCN,guestFlag=e.guest.flag,guestName=e.guest.name,guestNameCN=e.guest.nameCN,$("#host-vote-number").text(e.host.vote),$("#guest-vote-number").text(e.guest.vote),$("#flag-host").attr("src",cdn_root_path+"images/"+hostFlag+".png"),$("#flag-guest").attr("src",cdn_root_path+"images/"+guestFlag+".png"),$("#register-url").attr("href",e.register_url),$("#page1-title-time").text(gameDate),$("#vote-endTime").text("2. 投票截止时间："+voteEndTime),expired&&($(".vote-button").css({"background-color":"#95a5a6",cursor:"default"}).text("投票已截止"),$("#vote-button-1").css("background-color","#95a5a6"),$("#vote-button-2").css("background-color","#95a5a6")),$("#process-container").css("display","none")},submitPhoneNumber=function(e){if(console.log(e),void 0===e.errcode)$(".page2").css("display","none"),$(".page3").css("display","block"),$(".frame img").attr("src",cdn_root_path+"images/football-frame-5.png"),$("#short-url").val(shortUrl);else{var t;switch(e.errcode){case 400717:t="投票已截止！";break;case 400718:t="发生错误，请重新输入！";break;case 400719:t="手机号码错误！";break;case 400720:t="发生错误，请重新输入！";break;case 400721:t="此手机号已投过票了哦！";break;default:t="发生未知错误，请重新输入！"}$("#myModalLabel").text("发生错误"),$(".modal-body").text(t),$("#myModal").modal("show")}},handleAjaxFail=function(e){$("#myModalLabel").text(e),$(".modal-body").text("请刷新页面，尝试重新载入！"),$("#myModal").modal("show")},setImagePath=function(){$("img").each(function(e){var t=$(this).attr("src");void 0!==t&&$(this).attr("src",cdn_root_path+t)}),$("link").each(function(e){})};!function(){var e=$("body");e.css("width",window.innerWidth+"px"),e.css("height",window.innerHeight+"px"),setImagePath(),$("#process-container").css("display","block"),ajaxGet(testUrl,showInfo,handleAjaxFail),$("#vote-button-1").on("click",function(e){e.preventDefault(),expired||($(".page1").css("display","none"),$(".page2").css("display","block"),$(".frame img").attr("src",cdn_root_path+"images/football-frame-3.png"),voteTeam=hostName)}),$("#vote-button-2").on("click",function(e){e.preventDefault(),expired||($(".page1").css("display","none"),$(".page2").css("display","block"),$(".frame img").attr("src",cdn_root_path+"images/football-frame-3.png"),voteTeam=guestName)}),$("#confirm").on("click",function(e){e.preventDefault();var t=$(".page2-phone-card form input").val(),a=new RegExp("(^(13\\d|15[^4,\\D]|17[13678]|18\\d)\\d{8}|170[^346,\\D]\\d{7})$","g");if(a.test(t)){var o="phone="+t.toString()+"&team="+voteTeam;ajaxPost(testUrl,o,submitPhoneNumber,handleAjaxFail)}else $("#myModalLabel").text("发生错误"),$(".modal-body").text("手机号格式错误！请重新输入！"),$("#myModal").modal("show"),$("#modal-close").on("click",function(e){$(".page2-phone-card form input").val("")})})}();